# ExtraTextAreas for MODX 3.1+

Компонент добавляет дополнительные текстовые области на вкладку редактирования ресурса и хранит значения в отдельных таблицах.

## Возможности

- Управление списком дополнительных полей в разделе **Компоненты → ExtraTextAreas**.
- Автоматическая подгрузка активных полей на вкладку контента ресурса.
- Сохранение контента и выбранного редактора для каждого дополнительного поля.
- Авто-обнаружение доступных редакторов по активным плагинам системы (Ace/CKEditor/Tiny и т.п.).
- Установка через стандартный MODX **Установщик** (`*.transport.zip`).

## Ручная сборка без подключения к установленному MODX

Добавлен скрипт `php _build/build.manual.php`, который поднимает временное окружение MODX и собирает transport-пакет без использования вашего рабочего сайта MODX.

Требования:
- `php`
- `composer`
- `mysql` CLI
- доступный MySQL-сервер

Пример запуска:

```bash
MYSQL_HOST=127.0.0.1 MYSQL_USER=modx MYSQL_PASSWORD=modx MYSQL_DATABASE=modx php _build/build.manual.php
```

Результат:
- собранный пакет попадёт в `dist/`
- также обновится `dist/extratextareas-latest.transport.zip`

## Важно про установку

Установщик MODX не ставит «сырой» git-репозиторий. Нужен собранный архив вида:

- `extratextareas-<version>-<release>.transport.zip`

## Локальная сборка (если когда-нибудь появится доступ к CLI)

### 1) Репозиторий в корне MODX

```bash
php _build/build.transport.php
```

### 2) Репозиторий в отдельной папке

```bash
MODX_BASE_PATH=/path/to/modx php _build/build.transport.php
```

Скрипт проверяет наличие `config.core.php` и валидирует необходимые файлы перед упаковкой.


## Локальная сборка через браузер (без SSH/CLI)

Если у вас только FTP/файловый доступ, можно запускать сборку через веб-скрипт:

1. Распакуйте репозиторий в файловую систему сервера.
2. Откройте в браузере: `https://ваш-сайт/_build/build.web.php`
   - (совместимость) также можно открыть: `https://ваш-сайт/_build/build_web.php`
3. Если MODX расположен в другой директории, передайте параметр:
   - `https://ваш-сайт/_build/build.web.php?modx_base_path=/полный/путь/к/modx/`
4. Скрипт запустит `build.transport.php` отдельным PHP-процессом и покажет логи на странице.
5. Готовый пакет ищите в `core/packages/` вашего MODX.

> ⚠️ Рекомендация по безопасности: после сборки удалите `/_build/build.web.php` с сервера или ограничьте доступ к нему (например, по IP/basic-auth), чтобы никто посторонний не запускал сборку.

## Что устанавливается пакетом

- Namespace `extratextareas`.
- CMP (меню и action `home`).
- Плагин `ExtraTextAreas` (`OnDocFormRender`, `OnDocFormSave`).
- Файлы из `core/components/extratextareas/` и `assets/components/extratextareas/`.
- Таблицы `extratextareas_fields` и `extratextareas_values` (через resolver).

## Ограничение текущей версии

Выбор редактора для каждого поля сохраняется в БД. Для жёсткой привязки конкретного editor API к каждому textarea может потребоваться дополнительная интеграция с конкретными редакторными дополнениями.
